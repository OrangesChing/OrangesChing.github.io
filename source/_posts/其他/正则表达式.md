---
title: 正则表达式
date: 2020-11-23 10:42:23
tags:
  - 字符串匹配
categories:
  - 其他
---

# 正则表达式语法

## 匹配内容限定

### 常见字符匹配

| 语法             | 说明                             | 例子                       |
| ---------------- | -------------------------------- | -------------------------- |
| `.`              | 匹配除换行符 \n 之外的任何单字符 |                            |
| `\w`             | 匹配字母、数字、下划线           |                            |
| `\s`             | 匹配所有空白符，包括换行、空格、制表符、换页符等等 |                            |
|                  |                                                    |                            |
| `\d`             | 匹配数字                         | 匹配4位数字：`^\d\d\d\d$`  |
| `\b`             | 匹配单词的开始或结束             | 以abc开头的字符串：`\babc` |
| `^`              | 匹配字符串的开头                 | 以abc开头的字符串：`^abc`  |
| `$`              | 匹配字符串的结束                 |                            |
| `\u4e00-\u9fa5a` | 匹配中文                         |                            |
| `\f` | 匹配一个换页符                         ||
| `\n` | 匹配一个换行符                         ||
| `\r` | 匹配一个回车符                         ||
| `\t` | 匹配一个制表符                         ||
| `\v` | 匹配一个垂直制表符                     ||

### 转义

当正则表达式语法中的符号真实出现需匹配时 可转义成普通的字符，即在要转义的字符前面加个斜杠`\`
如：要匹配以`(ab)`开头的字符串：`^(\(ab\))*`

### 反义

前面说到元字符的都是要匹配什么什么，当然如果你想反着来，不想匹配某些字符，正则也提供了一些常用的反义元字符：

| 语法   | 说明                                   |                                           |
| ------ | -------------------------------------- | ----------------------------------------- |
| `\W`   | 匹配不是字母、数字、下划线、汉字的字符 |                                           |
| `\S`   | 匹配非空白符，包括换行                 |                                           |
| `\D`   | 匹配任意非数字的字符                   |                                           |
| `\B`   | 匹配不是单词开头或结束的位置           |                                           |
| `[^x]` | 匹配除x以外的任意字符                  | `[^aeiou]`匹配除aeiou几个字母外的任意字符 |



## 匹配内容位置限定

| 语法 | 说明                 | 例子                       |
| ---- | -------------------- | -------------------------- |
| `^`  | 匹配字符串的开头     | 以abc开头的字符串：`^abc`  |
| `$`  | 匹配字符串的结束     |                            |
| `\b` | 匹配单词的开始或结束 | 以abc开头的字符串：`\babc` |
| `\B` | 非单词边界匹配       |                            |


## 匹配内容重复次数限定——限定符

匹配重复次数加在内容限定的后面，限定符作用在与他左边最近的一个字符，默认是贪婪匹配（尽可能多的匹配文字），在后面加上一个`?`就可实现非贪婪匹配

| 语法    | 说明             | 例子                   |
| ------- | ---------------- | ---------------------- |
| `*`     | 重复零次或更多次 |                        |
| `+`     | 重复一次或更多次 |                        |
| `?`     | 重复零次或一次   |                        |
| `{n}`   | 重复n次          | 匹配4位数字：`^\d{4}$` |
| `{n,}`  | 重复n次或更多次  |                        |
| `{n,m}` | 重复n到m次       |                        |

> **贪婪匹配**
>
> 当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配尽可能多的字符，这匹配方式叫做贪婪匹配。
> 特性：一次性读入整个字符串进行匹配，每当不匹配就舍弃最右边一个字符，继续匹配，依次匹配和舍弃（这种匹配-舍弃的方式也叫做回溯），直到匹配成功或者把整个字符串舍弃完为止，因此它是一种最大化的数据返回，能多不会少。
>
> **懒惰匹配**
>
> 当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配尽可能少的字符，这匹配方式叫做懒惰匹配。
> 特性：从左到右，从字符串的最左边开始匹配，每次试图不读入字符匹配，匹配成功，则完成匹配，否则读入一个字符再匹配，依此循环（读入字符、匹配）直到匹配成功或者把字符串的字符匹配完为止。
>
> 如：`*?`、`+?`、`??`、`{n,m}?`

## 分组

正则表达式中用小括号`()`来做分组，也就是括号中的内容作为一个整体。

如：匹配字符串中包含0到多个ab开头：` ^(ab)*`

## 条件或

正则用符号` |` 来表示或，也叫做分支条件，当满足正则里的分支条件的任何一种条件时，都会当成是匹配成功

例如：匹配一个联通的号码（130/131/132/155/156/185/186/145/176等号段）
           可写为`^(130|131|132|155|156|185|186|145|176)\d{8}$`

## 区间

正则提供一个元字符中括号` [] `来表示区间条件。

例如：

- 限定0到9 可以写成`[0-9]`
- 限定A-Z 写成`[A-Z]`
- 限定某些数字` [165]`
- `^(130|131|132|155|156|185|186|145|176)\d{8}$`可写为`^((13[0-2])|(15[56])|(18[5-6])|145|176)\d{8}$`

# 正则进阶知识点

## 零宽断言

**断言：**俗话的断言就是“我断定什么什么”，而正则中的断言，就是说<u>正则可以指明在指定的内容的前面或后面会出现满足指定规则的内容</u>，意思正则也可以像人类那样断定什么什么，比如"ss1aa2bb3",正则可以用断言找出aa后面有bb3，也可以找出aa2前面有ss1.

**零宽：**就是没有宽度，在正则中，<u>断言只是匹配位置，不占字符，也就是说，匹配结果不会返回断言本身</u>

### 正向先行断言（正前瞻）

- 语法：`(?=pattern)`
- 作用：匹配pattern表达式的前面内容，不返回本身

举个例子：

**匹配内容：**`<span class="read-count">阅读数：641</span>`

**解析：**按照上所说的正向先行断言可以匹配表达式前面的内容，那意思就是`(?=</span>) `就可以匹配到前面的内容，则匹配到数字则在其前面加上数字匹配`\d+`

**正则：**`\d+(?=</span>)`

**结果：**641

### 正向后行断言（正后顾）

- 语法：`(?<=pattern)`
- 作用：匹配pattern表达式的后面的内容，不返回本身

举个例子：

**匹配内容：**`<span class="read-count">阅读数：641</span>`

**解析：**也可使用正向后行断言来匹配表达式后面的内容，即`(?<=<=<span class=\"read-count\">阅读数：)`就可匹配到前面的内容，则匹配到数字则在其后面上加上数字匹配`\d+`

**正则：**`(?<=<=<span class=\"read-count\">阅读数：)\d+`

**结果：**641

### 负向先行断言（负前瞻）

- 语法：`(?!pattern)`
- 作用：匹配非pattern表达式的前面内容，不返回本身。

举个例子：

**匹配内容：**`我爱祖国，我是祖国的花朵`

**解析：**要找到<u>不是的花朵前面</u>的**祖国**，可使用负向先行断言来非匹配表达式前面的内容，即`(?!的花朵)`

**正则：**`祖国(?!的花朵)`

### 负向后行断言（负后顾）

- 语法：`(?<!pattern)`
- 作用：匹配非pattern表达式的后面内容，不返回本身

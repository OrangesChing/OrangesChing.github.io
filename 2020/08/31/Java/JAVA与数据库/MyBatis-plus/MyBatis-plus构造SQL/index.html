<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>MyBatis-plus构造SQL | 大橙砸的日常记录</title><meta name="description" content="MyBatis-plus构造SQL"><meta name="keywords" content="ORM框架"><meta name="author" content="大橙砸"><meta name="copyright" content="大橙砸"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon2.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="MyBatis-plus构造SQL"><meta name="twitter:description" content="MyBatis-plus构造SQL"><meta name="twitter:image" content="https://orangesching.github.io/img/cover/cover.png"><meta property="og:type" content="article"><meta property="og:title" content="MyBatis-plus构造SQL"><meta property="og:url" content="https://orangesching.github.io/2020/08/31/Java/Java与数据库/MyBatis-plus/MyBatis-plus构造SQL/"><meta property="og:site_name" content="大橙砸的日常记录"><meta property="og:description" content="MyBatis-plus构造SQL"><meta property="og:image" content="https://orangesching.github.io/img/cover/cover.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://orangesching.github.io/2020/08/31/Java/Java与数据库/MyBatis-plus/MyBatis-plus构造SQL/"><link rel="prev" title="MyBatis-plus环境配置" href="https://orangesching.github.io/2020/09/01/Java/Java与数据库/MyBatis-plus/MyBatis-plus环境配置/"><link rel="next" title="Java操作关系型数据库" href="https://orangesching.github.io/2020/08/25/Java/Java与数据库/Java操作关系型数据库/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">大橙砸的日常记录</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="/img/my.jpg" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">74</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">24</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">33</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#CRUD接口"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">CRUD接口</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Mapper-CRUD-接口"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">Mapper CRUD 接口</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#增"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">增</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#删"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">删</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#改"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">改</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#查"><span class="toc_mobile_items-number">1.1.4.</span> <span class="toc_mobile_items-text">查</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Service-CRUD-接口"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">Service CRUD 接口</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Save"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text">Save</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#SaveOrUpdate"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text">SaveOrUpdate</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Remove"><span class="toc_mobile_items-number">1.2.3.</span> <span class="toc_mobile_items-text">Remove</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Update"><span class="toc_mobile_items-number">1.2.4.</span> <span class="toc_mobile_items-text">Update</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Get"><span class="toc_mobile_items-number">1.2.5.</span> <span class="toc_mobile_items-text">Get</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#List"><span class="toc_mobile_items-number">1.2.6.</span> <span class="toc_mobile_items-text">List</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Page"><span class="toc_mobile_items-number">1.2.7.</span> <span class="toc_mobile_items-text">Page</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Count"><span class="toc_mobile_items-number">1.2.8.</span> <span class="toc_mobile_items-text">Count</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Chain"><span class="toc_mobile_items-number">1.2.9.</span> <span class="toc_mobile_items-text">Chain</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#条件构造器"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">条件构造器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#AbstractWrapper"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">AbstractWrapper</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#比较符"><span class="toc_mobile_items-number">2.1.1.</span> <span class="toc_mobile_items-text">比较符</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#OR-AND"><span class="toc_mobile_items-number">2.1.2.</span> <span class="toc_mobile_items-text">OR / AND</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#BETWEEN"><span class="toc_mobile_items-number">2.1.3.</span> <span class="toc_mobile_items-text">BETWEEN</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#LIKE"><span class="toc_mobile_items-number">2.1.4.</span> <span class="toc_mobile_items-text">LIKE</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#NULL"><span class="toc_mobile_items-number">2.1.5.</span> <span class="toc_mobile_items-text">NULL</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#IN"><span class="toc_mobile_items-number">2.1.6.</span> <span class="toc_mobile_items-text">IN</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#GROUPBY"><span class="toc_mobile_items-number">2.1.7.</span> <span class="toc_mobile_items-text">GROUPBY</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ORDERBY"><span class="toc_mobile_items-number">2.1.8.</span> <span class="toc_mobile_items-text">ORDERBY</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#HAVING"><span class="toc_mobile_items-number">2.1.9.</span> <span class="toc_mobile_items-text">HAVING</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#EXISTS"><span class="toc_mobile_items-number">2.1.10.</span> <span class="toc_mobile_items-text">EXISTS</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#func"><span class="toc_mobile_items-number">2.1.11.</span> <span class="toc_mobile_items-text">func</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#apply"><span class="toc_mobile_items-number">2.1.12.</span> <span class="toc_mobile_items-text">apply</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#last"><span class="toc_mobile_items-number">2.1.13.</span> <span class="toc_mobile_items-text">last</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#QueryWrapper"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">QueryWrapper</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#SELECT"><span class="toc_mobile_items-number">2.2.1.</span> <span class="toc_mobile_items-text">SELECT</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#UpdateWrapper"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">UpdateWrapper</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#SET"><span class="toc_mobile_items-number">2.3.1.</span> <span class="toc_mobile_items-text">SET</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#LambdaWrapper"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">LambdaWrapper</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#LambdaQueryWrapper"><span class="toc_mobile_items-number">2.4.1.</span> <span class="toc_mobile_items-text">LambdaQueryWrapper</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#LambdaUpdateWrapper"><span class="toc_mobile_items-number">2.4.2.</span> <span class="toc_mobile_items-text">LambdaUpdateWrapper</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#自定义SQL"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">自定义SQL</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#方案一：原始的自定义SQL方法"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">方案一：原始的自定义SQL方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#方案二：自定义接口方法使用Wrapper条件构造器"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">方案二：自定义接口方法使用Wrapper条件构造器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用注解方式-Wrapper"><span class="toc_mobile_items-number">3.2.1.</span> <span class="toc_mobile_items-text">使用注解方式 + Wrapper</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#使用xml-配置方式-Wrapper"><span class="toc_mobile_items-number">3.2.2.</span> <span class="toc_mobile_items-text">使用xml 配置方式 + Wrapper</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#通过Wapper传递查询参数"><span class="toc_mobile_items-number">3.2.3.</span> <span class="toc_mobile_items-text">通过Wapper传递查询参数</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ActiveRecord"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">ActiveRecord</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#启动AR的准备工作"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text">启动AR的准备工作</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#使用AR"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text">使用AR</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CRUD接口"><span class="toc-number">1.</span> <span class="toc-text">CRUD接口</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapper-CRUD-接口"><span class="toc-number">1.1.</span> <span class="toc-text">Mapper CRUD 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#增"><span class="toc-number">1.1.1.</span> <span class="toc-text">增</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删"><span class="toc-number">1.1.2.</span> <span class="toc-text">删</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#改"><span class="toc-number">1.1.3.</span> <span class="toc-text">改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查"><span class="toc-number">1.1.4.</span> <span class="toc-text">查</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Service-CRUD-接口"><span class="toc-number">1.2.</span> <span class="toc-text">Service CRUD 接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Save"><span class="toc-number">1.2.1.</span> <span class="toc-text">Save</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SaveOrUpdate"><span class="toc-number">1.2.2.</span> <span class="toc-text">SaveOrUpdate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remove"><span class="toc-number">1.2.3.</span> <span class="toc-text">Remove</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Update"><span class="toc-number">1.2.4.</span> <span class="toc-text">Update</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get"><span class="toc-number">1.2.5.</span> <span class="toc-text">Get</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#List"><span class="toc-number">1.2.6.</span> <span class="toc-text">List</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Page"><span class="toc-number">1.2.7.</span> <span class="toc-text">Page</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Count"><span class="toc-number">1.2.8.</span> <span class="toc-text">Count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chain"><span class="toc-number">1.2.9.</span> <span class="toc-text">Chain</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#条件构造器"><span class="toc-number">2.</span> <span class="toc-text">条件构造器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AbstractWrapper"><span class="toc-number">2.1.</span> <span class="toc-text">AbstractWrapper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#比较符"><span class="toc-number">2.1.1.</span> <span class="toc-text">比较符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OR-AND"><span class="toc-number">2.1.2.</span> <span class="toc-text">OR / AND</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BETWEEN"><span class="toc-number">2.1.3.</span> <span class="toc-text">BETWEEN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LIKE"><span class="toc-number">2.1.4.</span> <span class="toc-text">LIKE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NULL"><span class="toc-number">2.1.5.</span> <span class="toc-text">NULL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IN"><span class="toc-number">2.1.6.</span> <span class="toc-text">IN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GROUPBY"><span class="toc-number">2.1.7.</span> <span class="toc-text">GROUPBY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ORDERBY"><span class="toc-number">2.1.8.</span> <span class="toc-text">ORDERBY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HAVING"><span class="toc-number">2.1.9.</span> <span class="toc-text">HAVING</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EXISTS"><span class="toc-number">2.1.10.</span> <span class="toc-text">EXISTS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#func"><span class="toc-number">2.1.11.</span> <span class="toc-text">func</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apply"><span class="toc-number">2.1.12.</span> <span class="toc-text">apply</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#last"><span class="toc-number">2.1.13.</span> <span class="toc-text">last</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QueryWrapper"><span class="toc-number">2.2.</span> <span class="toc-text">QueryWrapper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT"><span class="toc-number">2.2.1.</span> <span class="toc-text">SELECT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UpdateWrapper"><span class="toc-number">2.3.</span> <span class="toc-text">UpdateWrapper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SET"><span class="toc-number">2.3.1.</span> <span class="toc-text">SET</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LambdaWrapper"><span class="toc-number">2.4.</span> <span class="toc-text">LambdaWrapper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LambdaQueryWrapper"><span class="toc-number">2.4.1.</span> <span class="toc-text">LambdaQueryWrapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LambdaUpdateWrapper"><span class="toc-number">2.4.2.</span> <span class="toc-text">LambdaUpdateWrapper</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#自定义SQL"><span class="toc-number">3.</span> <span class="toc-text">自定义SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#方案一：原始的自定义SQL方法"><span class="toc-number">3.1.</span> <span class="toc-text">方案一：原始的自定义SQL方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#方案二：自定义接口方法使用Wrapper条件构造器"><span class="toc-number">3.2.</span> <span class="toc-text">方案二：自定义接口方法使用Wrapper条件构造器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用注解方式-Wrapper"><span class="toc-number">3.2.1.</span> <span class="toc-text">使用注解方式 + Wrapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用xml-配置方式-Wrapper"><span class="toc-number">3.2.2.</span> <span class="toc-text">使用xml 配置方式 + Wrapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过Wapper传递查询参数"><span class="toc-number">3.2.3.</span> <span class="toc-text">通过Wapper传递查询参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ActiveRecord"><span class="toc-number">4.</span> <span class="toc-text">ActiveRecord</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#启动AR的准备工作"><span class="toc-number">4.1.</span> <span class="toc-text">启动AR的准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用AR"><span class="toc-number">4.2.</span> <span class="toc-text">使用AR</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/cover/cover.png)"><div id="post-info"><div id="post-title"><div class="posttitle">MyBatis-plus构造SQL</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-08-31<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-06-21</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/Java与数据库/">Java与数据库</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/Java与数据库/MyBatis-plus/">MyBatis-plus</a></span><div class="post-meta-wordcount"><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="CRUD接口"><a href="#CRUD接口" class="headerlink" title="CRUD接口"></a>CRUD接口</h1><h2 id="Mapper-CRUD-接口"><a href="#Mapper-CRUD-接口" class="headerlink" title="Mapper CRUD 接口"></a>Mapper CRUD 接口</h2><div class="table-container">
<table>
<thead>
<tr>
<th>增</th>
<th>删</th>
<th>改</th>
<th>查</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>insert</code></td>
<td><code>delete</code> <br><code>deleteBatchIds</code><br><code>deleteById</code> <br><code>deleteByMap</code></td>
<td><code>update</code><br><code>updateById</code></td>
<td><code>selectById</code><br><code>selectOne</code><br><code>selectBatchIds</code><br><code>selectList</code><br><code>selectByMap</code><br><code>selectMaps</code><br><code>selectObjs</code><br><code>selectPage</code><br><code>selectMapsPage</code><br><code>selectCount</code></td>
</tr>
<tr>
<td>返回插入数据条数</td>
<td>返回删除数据条数</td>
<td>返回修改数据条数</td>
<td>返回查询数据</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>通用 CRUD 封装<code>BaseMapper</code>接口，为 <code>Mybatis-Plus</code> 启动时自动解析实体表关系映射转换为 <code>Mybatis</code> 内部对象注入容器</p>
</blockquote>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入一条记录</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(T entity)</span></span>;</span><br></pre></td></tr></table></figure>
<p>insert方法默认底层会增加uuid随机生成的id字段</p>
<p>所以使用此方法 必须在数据库id字段设置成bigint类型 （不然放不下这么长的数字）。在pojo中id属性不能为int和Integer 了 ， 可以用Long</p>
<p>id不仅是可以自动生成UUID 还可以自增 或者其他</p>
<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全部返回删除数据条数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 entity 条件，删除记录</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">(Wrapper&lt;T&gt; wrapper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除（根据ID 批量删除）</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteBatchIds</span><span class="params">(Collection&lt;? extends Serializable&gt; idList)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 ID 删除</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 columnMap 条件，删除记录</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteByMap</span><span class="params">(Map&lt;String, Object&gt; columnMap)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="改"><a href="#改" class="headerlink" title="改"></a>改</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据 whereEntity 条件，更新记录，没有set的属性将不会被修改</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">update</span><span class="params">(T entity, Wrapper&lt;T&gt; updateWrapper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 ID 修改，如果没有id就不会修改，没有set的属性将不会被修改</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateById</span><span class="params">(T entity)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 所有不存在的查询会返回空对象，不是NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 ID 查询</span></span><br><span class="line"><span class="function">T <span class="title">selectById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 entity 条件，查询一条记录，如果是多个会抛出异常，随机取一条加上限制条件 wrapper.last("LIMIT 1")</span></span><br><span class="line"><span class="function">T <span class="title">selectOne</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>; </span><br><span class="line"><span class="comment">// 多于一条记录返回会报错`TooManyResultsException`,`selectOne`内部调用的是selectList</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询（根据ID 批量查询）</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectBatchIds</span><span class="params">(Collection idList)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据Wrapper条件，查询全部记录 </span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectList</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查询（根据 columnMap 条件）</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">selectByMap</span><span class="params">(Map&lt;String, Object&gt; columnMap)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询全部记录，返回的是有值的字段组成的HashMap数组</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; selectMaps(Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询全部记录，只返回第一个字段的值(一般是ID)</span></span><br><span class="line"><span class="function">List&lt;Object&gt; <span class="title">selectObjs</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 entity 条件，查询全部记录（并翻页）</span></span><br><span class="line"><span class="function">IPage&lt;T&gt; <span class="title">selectPage</span><span class="params">(IPage&lt;T&gt; page, @Param(Constants.WRAPPER)</span> Wrapper&lt;T&gt; queryWrapper)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询全部记录（并翻页），返回的是有值的字段组成的HashMap数组</span></span><br><span class="line">IPage&lt;Map&lt;String, Object&gt;&gt; selectMapsPage(IPage&lt;T&gt; page, Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询总记录数</span></span><br><span class="line"><span class="function">Integer <span class="title">selectCount</span><span class="params">( Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="Service-CRUD-接口"><a href="#Service-CRUD-接口" class="headerlink" title="Service CRUD 接口"></a>Service CRUD 接口</h2><div class="table-container">
<table>
<thead>
<tr>
<th>Save</th>
<th>SaveOrUpdate</th>
<th>Remove</th>
<th>Update</th>
<th>Get</th>
<th>List</th>
<th>Page</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>新增</td>
<td>新增或修改</td>
<td>删除</td>
<td>修改</td>
<td>获取一条</td>
<td>获取全部</td>
<td>分页获取</td>
<td>计数</td>
</tr>
<tr>
<td><code>save</code><br><code>saveBatch</code></td>
<td><code>saveOrUpdate</code><br><code>saveOrUpdateBatch</code></td>
<td><code>remove</code><br><code>removeById</code><br><code>removeByMap</code><br><code>removeByIds</code></td>
<td><code>update</code><br><code>updateById</code><br><code>updateBatchById</code></td>
<td><code>getById</code><br><code>getOne</code><br><code>getMap</code><br><code>getObj</code></td>
<td><code>list</code><br><code>listByIds</code><br><code>listByMap</code><br><code>listMaps</code><br><code>listObjs</code></td>
<td><code>page</code><br><code>pageMaps</code></td>
<td><code>count</code></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<ul>
<li>通用 Service CRUD 封装<code>IService</code>接口，进一步封装 CRUD 采用 <code>get 查询单行</code> <code>remove 删除</code> <code>list 查询集合</code> <code>page 分页</code> 前缀命名方式区分 <code>Mapper</code> 层避免混淆，</li>
<li>建议如果存在自定义通用 Service 方法的可能，请创建自己的 <code>IBaseService</code> 继承 <code>Mybatis-Plus</code> 提供的基类</li>
</ul>
</blockquote>
<h3 id="Save"><a href="#Save" class="headerlink" title="Save"></a>Save</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entity没有set的属性不会被修改，entitiy即使set了id属性也不会使用这个值，所以如果数据库只有id不可重复的限制时，可重复save同一entity对象，这与saveOrUpdate不一样</span></span><br><span class="line"><span class="comment">// 次类方法插入完成会set entity中的id属性为数据表中的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入一条记录（选择字段，策略插入）</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">save</span><span class="params">(T entity)</span></span>;</span><br><span class="line"><span class="comment">// 插入（批量） 调用saveBatch(entityList, 1000)</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveBatch</span><span class="params">(Collection&lt;T&gt; entityList)</span></span>;</span><br><span class="line"><span class="comment">// 插入（批量）</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveBatch</span><span class="params">(Collection&lt;T&gt; entityList, <span class="keyword">int</span> batchSize)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="SaveOrUpdate"><a href="#SaveOrUpdate" class="headerlink" title="SaveOrUpdate"></a>SaveOrUpdate</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 次类方法插入完成会set entity中的id属性为数据表中的值</span></span><br><span class="line"><span class="comment">// saveOrUpdate依据id执行插入和修改操作，所以不能重复插入同一entity对象（除了第一次插入其他操作都会认为时修改），当id不存在时也会执行插入操作</span></span><br><span class="line"><span class="comment">// 谨慎用该类方法</span></span><br><span class="line"><span class="comment">// 没有任何数据修改也会返回true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TableId 注解存在更新记录，否插入一条记录</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveOrUpdate</span><span class="params">(T entity)</span></span>;</span><br><span class="line"><span class="comment">// 根据updateWrapper尝试更新，否继续执行saveOrUpdate(T)方法</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveOrUpdate</span><span class="params">(T entity, Wrapper&lt;T&gt; updateWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 批量修改插入</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveOrUpdateBatch</span><span class="params">(Collection&lt;T&gt; entityList)</span></span>;</span><br><span class="line"><span class="comment">// 批量修改插入</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">saveOrUpdateBatch</span><span class="params">(Collection&lt;T&gt; entityList, <span class="keyword">int</span> batchSize)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Remove"><a href="#Remove" class="headerlink" title="Remove"></a>Remove</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 没有删除记录时返回false，只要删除了一条记录就返回true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 entity 条件，删除记录</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 ID 删除</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">removeById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// 根据 columnMap 条件，删除记录</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">removeByMap</span><span class="params">(Map&lt;String, Object&gt; columnMap)</span></span>;</span><br><span class="line"><span class="comment">// 删除（根据ID 批量删除）,只要删除了list中的一条记录就会返回true</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">removeByIds</span><span class="params">(Collection&lt;? extends Serializable&gt; idList)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 没有更新记录则返回false，更新成功返回true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 UpdateWrapper 条件，更新记录 需要设置sqlset，没有设置setsql将报错BadSqlGrammarException</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">update</span><span class="params">(Wrapper&lt;T&gt; updateWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 whereEntity 条件，更新记录</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">update</span><span class="params">(T entity, Wrapper&lt;T&gt; updateWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 ID 选择修改 没有设置id将不更新</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">updateById</span><span class="params">(T entity)</span></span>;</span><br><span class="line"><span class="comment">// 根据ID 批量更新</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">updateBatchById</span><span class="params">(Collection&lt;T&gt; entityList)</span></span>;</span><br><span class="line"><span class="comment">// 根据ID 批量更新</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">updateBatchById</span><span class="params">(Collection&lt;T&gt; entityList, <span class="keyword">int</span> batchSize)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Get"><a href="#Get" class="headerlink" title="Get"></a>Get</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据 ID 查询</span></span><br><span class="line"><span class="function">T <span class="title">getById</span><span class="params">(Serializable id)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper，查询一条记录。结果集，如果是多个会抛出异常，随机取一条加上限制条件 wrapper.last("LIMIT 1")</span></span><br><span class="line"><span class="function">T <span class="title">getOne</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper，查询一条记录， throwEx为有多个 result 是否抛出异常</span></span><br><span class="line"><span class="function">T <span class="title">getOne</span><span class="params">(Wrapper&lt;T&gt; queryWrapper, <span class="keyword">boolean</span> throwEx)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper，查询一条记录，返回有值属性组成的map</span></span><br><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getMap</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper，查询一条记录的第一个字段（一般是id），mapper为映射函数</span></span><br><span class="line">&lt;V&gt; <span class="function">V <span class="title">getObj</span><span class="params">(Wrapper&lt;T&gt; queryWrapper, Function&lt;? <span class="keyword">super</span> Object, V&gt; mapper)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询所有</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 查询列表</span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">list</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 查询（根据ID 批量查询）</span></span><br><span class="line"><span class="function">Collection&lt;T&gt; <span class="title">listByIds</span><span class="params">(Collection&lt;? extends Serializable&gt; idList)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下返回有值属性组成的map</span></span><br><span class="line"><span class="comment">// 查询（根据 columnMap 条件）</span></span><br><span class="line"><span class="function">Collection&lt;T&gt; <span class="title">listByMap</span><span class="params">(Map&lt;String, Object&gt; columnMap)</span></span>;</span><br><span class="line"><span class="comment">// 查询所有列表</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; listMaps();</span><br><span class="line"><span class="comment">// 查询列表</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; listMaps(Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下返回记录的第一个字段（一般是ID）</span></span><br><span class="line"><span class="comment">// 查询全部记录</span></span><br><span class="line"><span class="function">List&lt;Object&gt; <span class="title">listObjs</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 查询全部记录</span></span><br><span class="line">&lt;V&gt; <span class="function">List&lt;V&gt; <span class="title">listObjs</span><span class="params">(Function&lt;? <span class="keyword">super</span> Object, V&gt; mapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询全部记录</span></span><br><span class="line"><span class="function">List&lt;Object&gt; <span class="title">listObjs</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询全部记录</span></span><br><span class="line">&lt;V&gt; <span class="function">List&lt;V&gt; <span class="title">listObjs</span><span class="params">(Wrapper&lt;T&gt; queryWrapper, Function&lt;? <span class="keyword">super</span> Object, V&gt; mapper)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Page"><a href="#Page" class="headerlink" title="Page"></a>Page</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无条件分页查询</span></span><br><span class="line"><span class="function">IPage&lt;T&gt; <span class="title">page</span><span class="params">(IPage&lt;T&gt; page)</span></span>;</span><br><span class="line"><span class="comment">// 条件分页查询</span></span><br><span class="line"><span class="function">IPage&lt;T&gt; <span class="title">page</span><span class="params">(IPage&lt;T&gt; page, Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下page中的record格式是Map&lt;String, Object&gt;，由有值字段组成</span></span><br><span class="line"><span class="comment">// 无条件分页查询</span></span><br><span class="line">IPage&lt;Map&lt;String, Object&gt;&gt; pageMaps(IPage&lt;T&gt; page);</span><br><span class="line"><span class="comment">// 条件分页查询</span></span><br><span class="line">IPage&lt;Map&lt;String, Object&gt;&gt; pageMaps(IPage&lt;T&gt; page, Wrapper&lt;T&gt; queryWrapper);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这个分页其实并不是物理分页，而是内存分页。<br>也就是说，查询的时候并没有limit语句。等配置了分页插件后才可以实现真正的分页。</p>
</blockquote>
<h3 id="Count"><a href="#Count" class="headerlink" title="Count"></a>Count</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询总记录数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 根据 Wrapper 条件，查询总记录数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(Wrapper&lt;T&gt; queryWrapper)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Chain"><a href="#Chain" class="headerlink" title="Chain"></a>Chain</h3><p>query</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 链式查询 普通</span></span><br><span class="line"><span class="function">QueryChainWrapper&lt;T&gt; <span class="title">query</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 链式查询 lambda 式。注意：不支持 Kotlin</span></span><br><span class="line"><span class="function">LambdaQueryChainWrapper&lt;T&gt; <span class="title">lambdaQuery</span><span class="params">()</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 示例：</span></span><br><span class="line">query().eq(<span class="string">"column"</span>, value).one();   <span class="comment">// 如果eq出来有多条记录会报错</span></span><br><span class="line">lambdaQuery().eq(Entity::getId, value).list();</span><br></pre></td></tr></table></figure>
<p>update</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 链式更改 普通</span></span><br><span class="line"><span class="function">UpdateChainWrapper&lt;T&gt; <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// 链式更改 lambda 式。注意：不支持 Kotlin </span></span><br><span class="line"><span class="function">LambdaUpdateChainWrapper&lt;T&gt; <span class="title">lambdaUpdate</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 示例：</span></span><br><span class="line">update().eq(<span class="string">"column"</span>, value).remove();</span><br><span class="line">lambdaUpdate().eq(Entity::getId, value).update(entity);</span><br></pre></td></tr></table></figure>
<h1 id="条件构造器"><a href="#条件构造器" class="headerlink" title="条件构造器"></a>条件构造器</h1><p><strong>条件构造器是用于生成sql的where条件的</strong></p>
<p>各种不同构造器的继承关系如下：</p>
<p><img alt="img" data-src="//orangesching.github.io/2020/08/31/Java/Java与数据库/MyBatis-plus/MyBatis-plus构造SQL/mybatis-wrapper.png" class="lazyload"></p>
<h2 id="AbstractWrapper"><a href="#AbstractWrapper" class="headerlink" title="AbstractWrapper"></a>AbstractWrapper</h2><blockquote>
<p>QueryWrapper(LambdaQueryWrapper) 和 UpdateWrapper(LambdaUpdateWrapper) 的父类<br>用于生成 sql 的 where 条件, entity 属性也用于生成 sql 的 where 条件</p>
</blockquote>
<ul>
<li>以下出现的第一个入参<code>boolean condition</code>表示该条件是否加入最后生成的sql中</li>
<li>以下代码块内的多个方法均为从上往下补全个别<code>boolean</code>类型的入参,默认为<code>true</code></li>
<li>以下出现的泛型<code>Param</code>均为<code>Wrapper</code>的子类实例(均具有<code>AbstractWrapper</code>的所有方法)</li>
<li>以下方法在入参中出现的<code>R</code>在普通<code>wrapper</code>中是<code>String</code>,在<code>LambdaWrapper</code>中是函数</li>
<li>以下方法入参中的<code>R column</code>均表示数据库字段,当<code>R</code>具体类型为<code>String</code>时则为数据库字段名(字段名是数据库关键字)而不是实体类数据字段名</li>
<li>使用中如果入参的<code>Map</code>或者<code>List</code>为空，则不会加入最后生成的sql中</li>
<li><code>val</code>不区分类型，最后全部转为<code>string</code></li>
</ul>
<h3 id="比较符"><a href="#比较符" class="headerlink" title="比较符"></a>比较符</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>allEq</td>
<td>全部eq(或个别isNull)</td>
<td><code>allEq(Map&lt;R, V&gt; params)</code> <br><code>allEq(Map&lt;R, V&gt; params, boolean null2IsNull)</code> <br><code>allEq(boolean condition, Map&lt;R, V&gt; params, boolean null2IsNull)</code></td>
</tr>
<tr>
<td>eq</td>
<td>等于 =</td>
<td><code>eq(R column, Object val)</code><br><code>eq(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>ne</td>
<td>不等于 &lt;&gt;</td>
<td><code>ne(R column, Object val)</code><br><code>ne(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>gt</td>
<td>大于 &gt;</td>
<td><code>gt(R column, Object val)</code><br><code>gt(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>ge</td>
<td>大于等于 >=</td>
<td><code>ge(R column, Object val)</code><br><code>ge(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>lt</td>
<td>小于 &lt;</td>
<td><code>lt(R column, Object val)</code><br><code>lt(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>le</td>
<td>小于等于 >=</td>
<td><code>le(R column, Object val)</code><br><code>le(boolean condition, R column, Object val)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="OR-AND"><a href="#OR-AND" class="headerlink" title="OR / AND"></a>OR / AND</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>or</td>
<td>拼接 OR</td>
<td><code>or()</code><br><code>or(boolean condition)</code><br><code>or(Consumer&lt;Param&gt; consumer)</code><br><code>or(boolean condition, Consumer&lt;Param&gt; consumer)</code><br>例：<code>or(i -&gt; i.eq(&quot;name&quot;, &quot;李白&quot;).ne(&quot;status&quot;, &quot;活着&quot;))</code>—-&gt;<br><code>or (name = &#39;李白&#39; and status &lt;&gt; &#39;活着&#39;)</code></td>
</tr>
<tr>
<td>and</td>
<td>AND 嵌套</td>
<td><code>and(Consumer&lt;Param&gt; consumer)</code><br><code>and(boolean condition, Consumer&lt;Param&gt; consumer)</code><br>例：<code>and(i -&gt; i.eq(&quot;name&quot;, &quot;李白&quot;).ne(&quot;status&quot;, &quot;活着&quot;))</code>—-&gt;<br><code>and (name = &#39;李白&#39; and status &lt;&gt; &#39;活着&#39;)</code></td>
</tr>
<tr>
<td>nested</td>
<td>正常嵌套 不带 AND 或者 OR</td>
<td><code>nested(Consumer&lt;Param&gt; consumer)</code><br><code>nested(boolean condition, Consumer&lt;Param&gt; consumer)</code><br>例: <code>nested(i -&gt; i.eq(&quot;name&quot;, &quot;李白&quot;).ne(&quot;status&quot;, &quot;活着&quot;))</code>—-&gt;<br><code>(name = &#39;李白&#39; and status &lt;&gt; &#39;活着&#39;)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="BETWEEN"><a href="#BETWEEN" class="headerlink" title="BETWEEN"></a>BETWEEN</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>between</td>
<td>BETWEEN</td>
<td><code>between(R column, Object val1, Object val2)</code><br><code>between(boolean condition, R column, Object val1, Object val2)</code></td>
</tr>
<tr>
<td>notBetween</td>
<td>NOT BETWEEN</td>
<td><code>notBetween(R column, Object val1, Object val2)</code><br><code>notBetween(boolean condition, R column, Object val1, Object val2)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>like</td>
<td>LIKE ‘%值%’</td>
<td><code>like(R column, Object val)</code><br><code>like(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>notLike</td>
<td>NOT LIKE ‘%值%’</td>
<td><code>notLike(R column, Object val)</code><br><code>notLike(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>likeLeft</td>
<td>LIKE ‘%值’</td>
<td><code>likeLeft(R column, Object val)</code><br><code>likeLeft(boolean condition, R column, Object val)</code></td>
</tr>
<tr>
<td>likeRight</td>
<td>LIKE ‘值%’</td>
<td><code>likeRight(R column, Object val)</code><br><code>likeRight(boolean condition, R column, Object val)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>isNull</td>
<td>IS NULL</td>
<td><code>isNull(R column)</code><br><code>isNull(boolean condition, R column)</code></td>
</tr>
<tr>
<td>isNotNull</td>
<td>IS NOT NULL</td>
<td><code>isNotNull(R column)</code><br><code>isNotNull(boolean condition, R column)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>in</td>
<td><code>IN (value.get(0), value.get(1), ...)</code><br><code>IN (v0, v1, ...)</code></td>
<td><code>in(R column, Collection&lt;?&gt; value)</code><br><code>in(boolean condition, R column, Collection&lt;?&gt; value)</code><br><code>in(R column, Object... values)</code><br><code>in(boolean condition, R column, Object... values)</code></td>
</tr>
<tr>
<td>notIn</td>
<td><code>NOT IN (value.get(0), value.get(1), ...)</code><br><code>NOT IN (v0, v1, ...)</code></td>
<td><code>notIn(R column, Collection&lt;?&gt; value)</code><br><code>notIn(boolean condition, R column, Collection&lt;?&gt; value)</code><br><code>notIn(R column, Object... values)</code><br><code>notIn(boolean condition, R column, Object... values)</code></td>
</tr>
<tr>
<td>inSql</td>
<td>IN ( sql语句 )<br>可嵌套select语句</td>
<td>inSql(R column, String inValue) inSql(boolean condition, R column, String inValue)</td>
</tr>
<tr>
<td>notInSql</td>
<td>NOT IN ( sql语句 )<br>可嵌套select语句</td>
<td>notInSql(R column, String inValue) notInSql(boolean condition, R column, String inValue)</td>
</tr>
</tbody>
</table>
</div>
<h3 id="GROUPBY"><a href="#GROUPBY" class="headerlink" title="GROUPBY"></a>GROUPBY</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>groupBy</td>
<td>GROUP BY 字段, …</td>
<td><code>groupBy(R... columns)</code><br><code>groupBy(boolean condition, R... columns)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="ORDERBY"><a href="#ORDERBY" class="headerlink" title="ORDERBY"></a>ORDERBY</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>orderByAsc</td>
<td>ORDER BY 字段, … ASC</td>
<td><code>orderByAsc(R... columns)</code><br><code>orderByAsc(boolean condition, R... columns)</code></td>
</tr>
<tr>
<td>orderByDesc</td>
<td>ORDER BY 字段, … DESC</td>
<td><code>orderByDesc(R... columns)</code><br><code>orderByDesc(boolean condition, R... columns)</code></td>
</tr>
<tr>
<td>orderBy</td>
<td>ORDER BY 字段, …</td>
<td><code>orderBy(boolean condition, boolean isAsc, R... columns)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="HAVING"><a href="#HAVING" class="headerlink" title="HAVING"></a>HAVING</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>having</td>
<td>HAVING ( sql语句 )</td>
<td><code>having(String sqlHaving, Object... params)</code><br><code>having(boolean condition, String sqlHaving, Object... params)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="EXISTS"><a href="#EXISTS" class="headerlink" title="EXISTS"></a>EXISTS</h3><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>sql</th>
<th>语句</th>
</tr>
</thead>
<tbody>
<tr>
<td>exists</td>
<td>EXISTS ( sql语句 )</td>
<td><code>exists(String existsSql)</code><br><code>exists(boolean condition, String existsSql)</code></td>
</tr>
<tr>
<td>notExists</td>
<td>NOT EXISTS ( sql语句 )</td>
<td><code>notExists(String notExistsSql)</code><br><code>notExists(boolean condition, String notExistsSql)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="func"><a href="#func" class="headerlink" title="func"></a>func</h3><p>func 方法(主要方便在出现if…else下调用不同方法能不断链)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func(Consumer&lt;Children&gt; consumer)</span><br><span class="line">func(<span class="keyword">boolean</span> condition, Consumer&lt;Children&gt; consumer)</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 例</span></span><br><span class="line">func(i -&gt; <span class="keyword">if</span>(<span class="keyword">true</span>) &#123;i.eq(<span class="string">"id"</span>, <span class="number">1</span>)&#125; <span class="keyword">else</span> &#123;i.ne(<span class="string">"id"</span>, <span class="number">1</span>)&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h3><p>拼接 sql</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apply(String applySql, Object... params)</span><br><span class="line">apply(<span class="keyword">boolean</span> condition, String applySql, Object... params)</span><br><span class="line"><span class="comment">// 例: </span></span><br><span class="line">apply(<span class="string">"id = 1"</span>)  <span class="comment">// id = 1</span></span><br><span class="line">apply(<span class="string">"date_format(dateColumn,'%Y-%m-%d') = '2008-08-08'"</span>)<span class="comment">// date_format(dateColumn,'%Y-%m-%d') = '2008-08-08'")`</span></span><br><span class="line">apply(<span class="string">"date_format(dateColumn,'%Y-%m-%d') = &#123;0&#125;"</span>, <span class="string">"2008-08-08"</span>)<span class="comment">// date_format(dateColumn,'%Y-%m-%d') = '2008-08-08'")`</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意:</p>
<p>该方法可用于数据库函数动态入参的params对应前面applySql内部的{index}部分.<br>这样是不会有sql注入风险的,反之会有!</p>
</blockquote>
<h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><p>无视优化规则直接拼接到 sql 的最后</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">last(String lastSql)</span><br><span class="line">last(<span class="keyword">boolean</span> condition, String lastSql)</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 例子</span></span><br><span class="line">last(<span class="string">"limit 1"</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意: </p>
<p>只能调用一次，多次调用以最后一次为准，<strong>有sql注入的风险</strong></p>
</blockquote>
<h2 id="QueryWrapper"><a href="#QueryWrapper" class="headerlink" title="QueryWrapper"></a>QueryWrapper</h2><p>在<code>QueryWrapper</code>中通过<code>new QueryWrapper().lambda()</code>获取<code>LambdaQueryWrapper</code></p>
<h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><p>设置查询字段，即select <em> from中</em>的地方写的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select(String... sqlSelect)</span><br><span class="line">select(Predicate&lt;TableFieldInfo&gt; predicate)</span><br><span class="line">select(Class&lt;T&gt; entityClass, Predicate&lt;TableFieldInfo&gt; predicate)</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 例: </span></span><br><span class="line">select(<span class="string">"id"</span>, <span class="string">"name"</span>, <span class="string">"age"</span>)</span><br><span class="line">select(i -&gt; i.getProperty().startsWith(<span class="string">"test"</span>))</span><br></pre></td></tr></table></figure>
<p>注意：带<code>select</code>的查询返回的数据依旧是整个实体类只不过其他字段都是<code>null</code>，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper classesWrapper = <span class="keyword">new</span> QueryWrapper&lt;Classes&gt;()</span><br><span class="line">                    .select(<span class="string">"id"</span>)</span><br><span class="line">                    .eq(<span class="string">"grade"</span>,<span class="string">"高三"</span>)</span><br><span class="line"># 用于接收的List&lt;Long&gt;就错了，其实接收到的是List&lt;Classes&gt;</span><br><span class="line">List&lt;Long&gt; classesList = classesService.list(classesWrapper);</span><br><span class="line"># 报错</span><br><span class="line">List&lt;Student&gt; students = studentService.list(<span class="keyword">new</span> QuerryWrapper&lt;Student&gt;().in(<span class="string">"class_id"</span>,classesList))</span><br></pre></td></tr></table></figure>
<h2 id="UpdateWrapper"><a href="#UpdateWrapper" class="headerlink" title="UpdateWrapper"></a>UpdateWrapper</h2><p>在<code>UpdateWrapper</code>中通过<code>new UpdateWrapper().lambda()</code>获取<code>LambdaUpdateWrapper</code></p>
<h3 id="SET"><a href="#SET" class="headerlink" title="SET"></a>SET</h3><p>SQL SET 字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">set(String column, Object val)</span><br><span class="line">set(<span class="keyword">boolean</span> condition, String column, Object val)</span><br><span class="line">setSql(String sql)</span><br><span class="line"><span class="comment">// 例: </span></span><br><span class="line">set(<span class="string">"name"</span>, <span class="string">"张三"</span>)</span><br><span class="line">set(<span class="string">"name"</span>, <span class="string">""</span>)   <span class="comment">// 数据库字段值变为空字符串</span></span><br><span class="line">set(<span class="string">"name"</span>, <span class="keyword">null</span>) <span class="comment">// 数据库字段值变为空</span></span><br><span class="line">setSql(<span class="string">"name = '张三'"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="LambdaWrapper"><a href="#LambdaWrapper" class="headerlink" title="LambdaWrapper"></a>LambdaWrapper</h2><p>使用lambda表达式的语法来操作</p>
<h3 id="LambdaQueryWrapper"><a href="#LambdaQueryWrapper" class="headerlink" title="LambdaQueryWrapper"></a>LambdaQueryWrapper</h3><p>在<code>QueryWrapper</code>中获取<code>LambdaQueryWrapper</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">queryWrapper.lambda()</span><br><span class="line">       .between(User::getAge,<span class="number">30</span>,<span class="number">60</span>)</span><br><span class="line">       .orderByDesc(User::getId);</span><br><span class="line">List&lt;User&gt; list = userService.list(queryWrapper);</span><br></pre></td></tr></table></figure>
<h3 id="LambdaUpdateWrapper"><a href="#LambdaUpdateWrapper" class="headerlink" title="LambdaUpdateWrapper"></a>LambdaUpdateWrapper</h3><p>在<code>UpdateWrapper</code>中获取<code>LambdaUpdateWrapper</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UpdateWrapper&lt;User&gt; updateWrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">updateWrapper.lambda()</span><br><span class="line">	.le(User::getAge, <span class="number">30</span>)</span><br><span class="line">	.setSql(<span class="string">"email = 'abc@163.com'"</span>);</span><br><span class="line">userService.update(updateWrapper);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，使用<code>save()</code>接口和<code>update()</code>更新时若<code>wrapper</code>为<code>UpdateWrapper</code>，则为<code>null</code>的字段讲被跳过而不会更新为<code>null</code>，所以如果需要将某一字段置为null时，应使用<code>LambdaUpdateWrapper</code></p>
</blockquote>
<h1 id="自定义SQL"><a href="#自定义SQL" class="headerlink" title="自定义SQL"></a>自定义SQL</h1><h2 id="方案一：原始的自定义SQL方法"><a href="#方案一：原始的自定义SQL方法" class="headerlink" title="方案一：原始的自定义SQL方法"></a>方案一：原始的自定义SQL方法</h2><p>注意要在application.yml中配置Mapper接口对应的xml文件所在位置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.test.mapper.WxUserExtMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--注意上面的namespace一定要修改--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 通用查询映射结果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.test.entity.WxUser"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"openid"</span> <span class="attr">property</span>=<span class="string">"openid"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"nickname"</span> <span class="attr">property</span>=<span class="string">"nickname"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--以下是新增的方法--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectMethod"</span> <span class="attr">resultType</span>=<span class="string">"com.test.entity.WxUser"</span>&gt;</span></span><br><span class="line">        select * from wx_user;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"oneUser"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.Integer"</span> <span class="attr">resultType</span>=<span class="string">"com.test.entity.WxUser"</span>&gt;</span></span><br><span class="line">        select * from wx_user WHERE id = #&#123;id&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>mapper文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WxUserExtMapper</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function">List&lt;WxUser&gt; <span class="title">selectMethod</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">WxUser <span class="title">oneUser</span><span class="params">(@Param(<span class="string">"id"</span>)</span> Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方案二：自定义接口方法使用Wrapper条件构造器"><a href="#方案二：自定义接口方法使用Wrapper条件构造器" class="headerlink" title="方案二：自定义接口方法使用Wrapper条件构造器"></a>方案二：自定义接口方法使用Wrapper条件构造器</h2><p>如果我们想在自定义的方法中，使用Wrapper条件构造器。可以参考下面的方式实现。这种方式虽然简单，但仍然只适用于单表（可以是多表关联查询，但查询条件也是基于单表的）。</p>
<h3 id="使用注解方式-Wrapper"><a href="#使用注解方式-Wrapper" class="headerlink" title="使用注解方式 + Wrapper"></a>使用注解方式 + Wrapper</h3><p><code>${ew.customSqlSegment}</code>是一个查询条件占位符，代表Wapper查询条件，用于生成where</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from `user` $&#123;ew.customSqlSegment&#125;"</span>)</span><br><span class="line"><span class="function">List&lt;User&gt; <span class="title">selectAll</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper wrapper)</span>;</span><br></pre></td></tr></table></figure>
<h3 id="使用xml-配置方式-Wrapper"><a href="#使用xml-配置方式-Wrapper" class="headerlink" title="使用xml 配置方式 + Wrapper"></a>使用xml 配置方式 + Wrapper</h3><p><code>${ew.customSqlSegment}</code>是一个查询条件占位符，代表Wapper查询条件，用于生成where</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">List&lt;User&gt; <span class="title">selectAll</span><span class="params">(@Param(Constants.WRAPPER)</span> Wrapper wrapper)</span>;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"selectAll"</span> resultType=<span class="string">"com.zimug.example.model.User"</span>&gt;</span><br><span class="line">  select * from `user` $&#123;ew.customSqlSegment&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<h3 id="通过Wapper传递查询参数"><a href="#通过Wapper传递查询参数" class="headerlink" title="通过Wapper传递查询参数"></a>通过Wapper传递查询参数</h3><p>上面两种方式任意选择一种，参数都是Wrapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCustomSQL2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  LambdaQueryWrapper&lt;User&gt; query = <span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">  query.eq(User::getName, <span class="string">"字母"</span>);</span><br><span class="line"></span><br><span class="line">  List&lt;User&gt; list = userMapper.selectAll(query);</span><br><span class="line">  list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 最终得到的SQL</span></span><br><span class="line"><span class="comment">// SELECT id,name,age,email </span></span><br><span class="line"><span class="comment">// FROM user </span></span><br><span class="line"><span class="comment">// WHERE name = '字母'</span></span><br></pre></td></tr></table></figure>
<h1 id="ActiveRecord"><a href="#ActiveRecord" class="headerlink" title="ActiveRecord"></a>ActiveRecord</h1><p>Active Record(活动记录)，是一种领域模型模式，特点是一个模型类对应关系型数据库中的一个表，而模型类的一个实例对应表中的一行记录。</p>
<p>MyBatis-plus仅需让实体类继承<code>Model</code>类且实现主键指定方法即可</p>
<h2 id="启动AR的准备工作"><a href="#启动AR的准备工作" class="headerlink" title="启动AR的准备工作"></a>启动AR的准备工作</h2><p>domain</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">User</span>&gt; </span>&#123;    <span class="comment">// 实体类继承Model类，重写pkVal方法</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">    <span class="comment">//重写这个方法，return当前类的主键</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Serializable <span class="title">pkVal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong>虽然AR模式不会直接调用该接口，但是一定要定义，否则使用AR时会报空指针异常。</p>
<h2 id="使用AR"><a href="#使用AR" class="headerlink" title="使用AR"></a>使用AR</h2><p>使用时并不需要注入mapper接口。AR操作是通过对象本身间接调用Mapper的相关方法，AR的大部分接口也与Mapper同名，比如要insert一个user，那就用这个user调用insert方法即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner.class)</span><br><span class="line"><span class="meta">@ContextConfiguration</span>(&#123;<span class="string">"classpath:spring/spring-dao.xml"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAR</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 插入操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setName(<span class="string">"林青霞"</span>);</span><br><span class="line">        user.setAge(<span class="number">22</span>);</span><br><span class="line">        user.setGender(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">boolean</span> result = user.insert();</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 更新操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        user.setId(<span class="number">1</span>);</span><br><span class="line">        user.setName(<span class="string">"刘亦菲"</span>);</span><br><span class="line">        <span class="keyword">boolean</span> result = user.updateById();</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 查询操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArSelect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        <span class="comment">//1、根据id查询</span></span><br><span class="line">        <span class="comment">//user = user.selectById(1);</span></span><br><span class="line">        <span class="comment">//或者这样用</span></span><br><span class="line">        <span class="comment">//user.setId(1);</span></span><br><span class="line">        <span class="comment">//user = user.selectById();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、查询所有</span></span><br><span class="line">        <span class="comment">//List&lt;User&gt; users = user.selectAll();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3、根据条件查询</span></span><br><span class="line">        <span class="comment">//List&lt;User&gt; users = user.selectList(new EntityWrapper&lt;User&gt;().like("name","刘"));</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4、查询符合条件的总数</span></span><br><span class="line">        <span class="keyword">int</span> result = user.selectCount(<span class="keyword">new</span> EntityWrapper&lt;User&gt;().eq(<span class="string">"gender"</span>,<span class="number">1</span>));</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 删除操作，删除数据库中不存在的数据，结果也是true</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        <span class="comment">//删除数据库中不存在的数据也是返回true</span></span><br><span class="line">        <span class="comment">//1、根据id删除数据</span></span><br><span class="line">        <span class="comment">//boolean result = user.deleteById(1);</span></span><br><span class="line">        <span class="comment">//或者这样写</span></span><br><span class="line">        <span class="comment">//user.setId(1);</span></span><br><span class="line">        <span class="comment">//boolean result = user.deleteById();</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2、根据条件删除</span></span><br><span class="line">        <span class="keyword">boolean</span> result = user.delete(<span class="keyword">new</span> EntityWrapper&lt;User&gt;().like(<span class="string">"name"</span>,<span class="string">"玲"</span>));</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 分页操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testArPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">       User user = <span class="keyword">new</span> User();</span><br><span class="line">       Page&lt;User&gt; page =</span><br><span class="line">               user.selectPage(<span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>,<span class="number">4</span>),</span><br><span class="line">               <span class="keyword">new</span> EntityWrapper&lt;User&gt;().like(<span class="string">"name"</span>,<span class="string">"刘"</span>));</span><br><span class="line">       List&lt;User&gt; users = page.getRecords();</span><br><span class="line">       System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>分页操作的补充：</strong></p>
<p>这个分页方法和BaseMapper提供的分页一样都是内存分页，并非物理分页，因为sql语句中没用limit，和BaseMapper的selectPage方法一样，配置了分页插件后就可以实现真正的物理分页。</p>
<p>AR的分页方法与BaseMapper提供的分页方法不同的是，BaseMapper的selectPage方法返回值是查询到的记录的list集合，而AR的selectPage方法返回的是page对象，该page对象封装了查询到的信息，可以通过getRecords方法获取信息。</p>
</blockquote>
<p>参考：</p>
<p><a href="https://www.jianshu.com/p/a4d5d310daf8" target="_blank" rel="noopener">https://www.jianshu.com/p/a4d5d310daf8</a></p>
<p><a href="https://mybatis.plus/" target="_blank" rel="noopener">https://mybatis.plus/</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">大橙砸</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://orangesching.github.io/2020/08/31/Java/Java与数据库/MyBatis-plus/MyBatis-plus构造SQL/">https://orangesching.github.io/2020/08/31/Java/Java与数据库/MyBatis-plus/MyBatis-plus构造SQL/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://orangesching.github.io">大橙砸的日常记录</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ORM框架/">ORM框架    </a></div><div class="post_share"><div class="social-share" data-image="/img/cover/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/09/01/Java/Java与数据库/MyBatis-plus/MyBatis-plus环境配置/"><img class="prev_cover lazyload" data-src="/img/cover/cover2.gif" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>MyBatis-plus环境配置</span></div></a></div><div class="next-post pull_right"><a href="/2020/08/25/Java/Java与数据库/Java操作关系型数据库/"><img class="next_cover lazyload" data-src="/img/cover/cover.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Java操作关系型数据库</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/25/Java/Java与数据库/Java操作关系型数据库/" title="Java操作关系型数据库"><img class="relatedPosts_cover lazyload" data-src="/img/cover/cover.png"><div class="relatedPosts_title">Java操作关系型数据库</div></a></div><div class="relatedPosts_item"><a href="/2021/01/04/Java/Java与数据库/MyBatis-plus/MyBatis-plus踩坑记录/" title="MyBatis-plus踩坑记录"><img class="relatedPosts_cover lazyload" data-src="/img/cover/cover.png"><div class="relatedPosts_title">MyBatis-plus踩坑记录</div></a></div><div class="relatedPosts_item"><a href="/2020/09/01/Java/Java与数据库/MyBatis-plus/MyBatis-plus运行原理/" title="MyBatis-plus运行原理"><img class="relatedPosts_cover lazyload" data-src="/img/cover/cover2.gif"><div class="relatedPosts_title">MyBatis-plus运行原理</div></a></div><div class="relatedPosts_item"><a href="/2020/09/01/Java/Java与数据库/MyBatis-plus/MyBatis-plus环境配置/" title="MyBatis-plus环境配置"><img class="relatedPosts_cover lazyload" data-src="/img/cover/cover2.gif"><div class="relatedPosts_title">MyBatis-plus环境配置</div></a></div></div><div class="clear_both"></div></div></div></div><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2021 By 大橙砸</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script async src="/js/search/local-search.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>